<header>
    <div class="container">
        <nav>
            <a href="/" class="logo-link">
                <img src="/assets/img/logo.png" alt="TechIndustry Logo" class="logo-img">
            </a>
            <div class="nav-links" id="navLinks">
                <button onclick="location.href='/'" class="{{#ifCond currentPath '==' '/'}}nav-active{{/ifCond}}">–ì–æ–ª–æ–≤–Ω–∞</button>
                <button onclick="location.href='/leaderboard'" class="{{#ifCond currentPath '==' '/leaderboard'}}nav-active{{/ifCond}}">–õ—ñ–¥–µ—Ä–±–æ—Ä–¥</button>
                <button onclick="location.href='/roadmap'" class="{{#ifCond currentPath '==' '/roadmap'}}nav-active{{/ifCond}}">–†–æ–∞–¥–º–∞–ø–∏</button>
                <button onclick="location.href='/courses'" class="{{#ifCond currentPath '==' '/courses'}}nav-active{{/ifCond}}">–ö—É—Ä—Å–∏</button>
                <button onclick="location.href='/quiz'" class="{{#ifCond currentPath '==' '/quiz'}}nav-active{{/ifCond}}">–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è</button>
                <button onclick="location.href='/about'" class="{{#ifCond currentPath '==' '/about'}}nav-active{{/ifCond}}">–ü—Ä–æ –Ω–∞—Å</button>
                <button onclick="location.href='/faq'" class="{{#ifCond currentPath '==' '/faq'}}nav-active{{/ifCond}}">FAQ</button>

                {{#if user}}
                    <button onclick="location.href='/profile'" class="{{#ifCond currentPath '==' '/profile'}}nav-active{{/ifCond}}">–ú–æ—î –Ω–∞–≤—á–∞–Ω–Ω—è</button>
                    <div class="user-menu">
                        <div class="user-avatar" onclick="document.getElementById('dropdownMenu').classList.toggle('show')">
                            {{#if user.Customer.avatar_data}}
                                <img src="{{user.Customer.avatar_data}}" style="width:100%;height:100%;border-radius:50%;object-fit:cover;">
                            {{else}}
                                <span>{{substring user.username 0 1}}</span>
                            {{/if}}
                        </div>
                        <div class="dropdown-menu" id="dropdownMenu">
                            <a href="/profile" class="dropdown-item">üë§ –ü—Ä–æ—Ñ—ñ–ª—å</a>
                            <a href="/settings" class="dropdown-item">‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</a>
                            <div class="dropdown-divider"></div>
                            <a href="#" onclick="logout(event)" class="dropdown-item logout">üö™ –í–∏–π—Ç–∏</a>
                        </div>
                    </div>
                {{else}}
                    <div id="authSlot">
                        <button class="btn btn-primary" onclick="location.href='/login'">–£–≤—ñ–π—Ç–∏</button>
                    </div>
                {{/if}}
            </div>
        </nav>
    </div>
</header>

<script>
    async function logout(event) {
        event.preventDefault();
        try {
            await fetch('/api/auth/logout', { method: 'POST' });
            window.location.replace('/');
        } catch (e) {
            console.error('Logout error:', e);
        }
    }

    window.onclick = function(event) {
        if (!event.target.closest('.user-menu')) {
            const dropdown = document.getElementById('dropdownMenu');
            if (dropdown && dropdown.classList.contains('show')) {
                dropdown.classList.remove('show');
            }
        }
    }
</script>