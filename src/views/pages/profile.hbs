<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}}</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/index.css">
    <link rel="stylesheet" href="/css/profile.css">
</head>
<body>

{{> nav}}

<section class="profile-section">
    <div class="container">
        <div class="profile-header">
            <div class="profile-info">
                <div class="profile-avatar-large">

                    {{#if user.Customer.avatar_data}}
                        <img src="{{user.Customer.avatar_data}}" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">
                    {{else}}
                        <span id="profileInitials">{{substring user.username 0 2}}</span>

                    {{/if}}
                </div>
                <div class="profile-details">
                    <h1 id="profileUsername">{{user.username}}</h1>
                    <p class="profile-email">{{user.Customer.email}}</p>
                    <div class="profile-stats-inline">
                        <span>üìö <strong>{{stats.total}}</strong> –∫—É—Ä—Å—ñ–≤</span>
                        <span>‚úÖ <strong>{{stats.completed}}</strong> –∑–∞–≤–µ—Ä—à–µ–Ω–æ</span>
                        <span>üî• <strong>{{stats.streak}}</strong> –¥–Ω—ñ–≤ –ø—ñ–¥—Ä—è–¥</span>
                    </div>

                </div>
            </div>
            <button class="btn btn-secondary" onclick="location.href='/settings'">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å</button>
        </div>

        <h2 class="section-title" style="text-align: center; margin: 40px 0;">–ú–æ—ó –∫—É—Ä—Å–∏</h2>

        <div class="courses-grid" id="coursesGrid">
            {{#if progress}}
                {{#each progress}}
                    <div class="course-progress-card glass">
                        <div class="course-header">
                            <div class="course-icon-small">
                                {{{getCourseIcon this.course.category this.course.slug this.course.title}}}
                            </div>
                            <div class="course-badge {{#if this.isFinished}}completed{{else}}in-progress{{/if}}">
                                {{#if this.isFinished}}–ó–∞–≤–µ—Ä—à–µ–Ω–æ{{else}}–í –ø—Ä–æ—Ü–µ—Å—ñ{{/if}}
                            </div>
                        </div>

                        <h3 class="course-name">{{this.course.title}}</h3>
                        <p class="course-progress-text">{{this.completedCount}} –∑ {{this.totalLessons}} —É—Ä–æ–∫—ñ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ</p>

                        <div class="progress-bar-container">
                            <div class="progress-bar-fill {{#if this.isFinished}}completed{{/if}}" style="width: {{this.percent}}%"></div>
                        </div>

                        <div class="course-meta-small" style="margin-bottom: 10px;">
                            <span>‚è±Ô∏è {{this.completedHours}}/{{this.totalHours}} –≥–æ–¥</span>
                            <span class="progress-percent">{{this.percent}}%</span>
                        </div>

                        <div class="course-actions-stack" style="display: flex; flex-direction: column; gap: 10px; margin-top: 5px;">
                            <button class="btn {{#if this.isFinished}}btn-secondary{{else}}btn-primary{{/if}} btn-continue"
                                    onclick="location.href='/course/{{this.course.slug}}'">
                                {{#if this.isFinished}}–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∫—É—Ä—Å{{else}}–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –Ω–∞–≤—á–∞–Ω–Ω—è{{/if}}
                            </button>

                            <button class="btn btn-primary {{#unless this.isFinished}}btn-disabled{{/unless}}"
                                    {{#unless this.isFinished}}disabled{{/unless}}
                                    onclick="window.location.href='/certificate?course={{this.course_id}}'">
                            –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç
                            </button>
                        </div>
                    </div>
                {{/each}}
            {{else}}
                <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px;">
                    <div style="font-size: 48px; margin-bottom: 20px;">üìö</div>
                    <h3>–í–∏ —â–µ –Ω–µ —Ä–æ–∑–ø–æ—á–∞–ª–∏ –∂–æ–¥–Ω–æ–≥–æ –∫—É—Ä—Å—É</h3>
                    <button class="btn btn-primary" onclick="location.href='/courses'">–ü–µ—Ä–µ–π—Ç–∏ –¥–æ –∫–∞—Ç–∞–ª–æ–≥—É</button>
                </div>
            {{/if}}
        </div>
    </div>
</section>
{{> footer}}
<script src="/js/index.js"></script>
<script src="/js/profile.js"></script>
</body>
</html>